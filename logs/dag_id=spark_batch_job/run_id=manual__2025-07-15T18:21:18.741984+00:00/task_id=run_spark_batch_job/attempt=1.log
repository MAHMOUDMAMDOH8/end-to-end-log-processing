{"timestamp":"2025-07-15T18:21:19.538994","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-15T18:21:19.539966","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/spark_batch_job_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-15T18:21:19.556986","level":"info","event":"Tmp dir root location: /tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:19.557750","level":"info","event":"Running command: ['/usr/bin/bash', '-c', 'spark-submit --jars /tmp/postgresql-42.7.3.jar /opt/airflow/scripts/spark_jop/batch_jop.py']","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:19.585150","level":"info","event":"Output:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:19.918804","level":"info","event":"WARNING: Using incubator modules: jdk.incubator.vector","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:23.991728","level":"info","event":"25/07/15 18:21:23 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:26.976056","level":"info","event":"Using Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:26.988745","level":"info","event":"25/07/15 18:21:26 INFO SparkContext: Running Spark version 4.0.0","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:26.993999","level":"info","event":"25/07/15 18:21:26 INFO SparkContext: OS info Linux, 6.11.0-29-generic, amd64","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:26.994869","level":"info","event":"25/07/15 18:21:26 INFO SparkContext: Java version 17.0.15","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.047305","level":"info","event":"25/07/15 18:21:27 INFO ResourceUtils: ==============================================================","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.049288","level":"info","event":"25/07/15 18:21:27 INFO ResourceUtils: No custom resources configured for spark.driver.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.051881","level":"info","event":"25/07/15 18:21:27 INFO ResourceUtils: ==============================================================","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.053107","level":"info","event":"25/07/15 18:21:27 INFO SparkContext: Submitted application: Batch Job","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.112467","level":"info","event":"25/07/15 18:21:27 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.120719","level":"info","event":"25/07/15 18:21:27 INFO ResourceProfile: Limiting resource is cpu","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.127474","level":"info","event":"25/07/15 18:21:27 INFO ResourceProfileManager: Added ResourceProfile id: 0","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.234235","level":"info","event":"25/07/15 18:21:27 INFO SecurityManager: Changing view acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.235589","level":"info","event":"25/07/15 18:21:27 INFO SecurityManager: Changing modify acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.236426","level":"info","event":"25/07/15 18:21:27 INFO SecurityManager: Changing view acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.237283","level":"info","event":"25/07/15 18:21:27 INFO SecurityManager: Changing modify acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.241831","level":"info","event":"25/07/15 18:21:27 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: airflow groups with view permissions: EMPTY; users with modify permissions: airflow; groups with modify permissions: EMPTY; RPC SSL disabled","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.671593","level":"info","event":"25/07/15 18:21:27 INFO Utils: Successfully started service 'sparkDriver' on port 38395.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.733159","level":"info","event":"25/07/15 18:21:27 INFO SparkEnv: Registering MapOutputTracker","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.756148","level":"info","event":"25/07/15 18:21:27 INFO SparkEnv: Registering BlockManagerMaster","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.790916","level":"info","event":"25/07/15 18:21:27 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.791291","level":"info","event":"25/07/15 18:21:27 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.798507","level":"info","event":"25/07/15 18:21:27 INFO SparkEnv: Registering BlockManagerMasterHeartbeat","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.846962","level":"info","event":"25/07/15 18:21:27 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-8b715ed1-af0e-4b5c-a796-33b91e0b23af","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:27.920436","level":"info","event":"25/07/15 18:21:27 INFO SparkEnv: Registering OutputCommitCoordinator","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.243100","level":"info","event":"25/07/15 18:21:28 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.421783","level":"info","event":"25/07/15 18:21:28 INFO Utils: Successfully started service 'SparkUI' on port 4040.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.519922","level":"info","event":"25/07/15 18:21:28 INFO SparkContext: Added JAR file:///tmp/postgresql-42.7.3.jar at spark://ee98e9136741:38395/jars/postgresql-42.7.3.jar with timestamp 1752603686957","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.567056","level":"info","event":"25/07/15 18:21:28 INFO SecurityManager: Changing view acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.568338","level":"info","event":"25/07/15 18:21:28 INFO SecurityManager: Changing modify acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.568583","level":"info","event":"25/07/15 18:21:28 INFO SecurityManager: Changing view acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.570323","level":"info","event":"25/07/15 18:21:28 INFO SecurityManager: Changing modify acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.572882","level":"info","event":"25/07/15 18:21:28 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: airflow groups with view permissions: EMPTY; users with modify permissions: airflow; groups with modify permissions: EMPTY; RPC SSL disabled","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.842471","level":"info","event":"25/07/15 18:21:28 INFO Executor: Starting executor ID driver on host ee98e9136741","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.843101","level":"info","event":"25/07/15 18:21:28 INFO Executor: OS info Linux, 6.11.0-29-generic, amd64","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.845026","level":"info","event":"25/07/15 18:21:28 INFO Executor: Java version 17.0.15","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.874880","level":"info","event":"25/07/15 18:21:28 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.879822","level":"info","event":"25/07/15 18:21:28 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@4bc00ede for default.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:28.934013","level":"info","event":"25/07/15 18:21:28 INFO Executor: Fetching spark://ee98e9136741:38395/jars/postgresql-42.7.3.jar with timestamp 1752603686957","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.054109","level":"info","event":"25/07/15 18:21:29 INFO TransportClientFactory: Successfully created connection to ee98e9136741/172.19.0.11:38395 after 61 ms (0 ms spent in bootstraps)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.072719","level":"info","event":"25/07/15 18:21:29 INFO Utils: Fetching spark://ee98e9136741:38395/jars/postgresql-42.7.3.jar to /tmp/spark-ded214d5-9943-4e9e-a025-64c4fe61cc17/userFiles-b47d9e55-f759-4044-b949-d4d4a0dad801/fetchFileTemp2971658236762899759.tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.133175","level":"info","event":"25/07/15 18:21:29 INFO Executor: Adding file:/tmp/spark-ded214d5-9943-4e9e-a025-64c4fe61cc17/userFiles-b47d9e55-f759-4044-b949-d4d4a0dad801/postgresql-42.7.3.jar to class loader default","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.155061","level":"info","event":"25/07/15 18:21:29 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42971.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.155543","level":"info","event":"25/07/15 18:21:29 INFO NettyBlockTransferService: Server created on ee98e9136741:42971","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.162234","level":"info","event":"25/07/15 18:21:29 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.205240","level":"info","event":"25/07/15 18:21:29 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ee98e9136741, 42971, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.224704","level":"info","event":"25/07/15 18:21:29 INFO BlockManagerMasterEndpoint: Registering block manager ee98e9136741:42971 with 434.4 MiB RAM, BlockManagerId(driver, ee98e9136741, 42971, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.235524","level":"info","event":"25/07/15 18:21:29 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ee98e9136741, 42971, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:29.243032","level":"info","event":"25/07/15 18:21:29 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ee98e9136741, 42971, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:34.903666Z","level":"error","event":"Server indicated the task shouldn't be running anymore. Terminating process","detail":{"detail":{"reason":"not_running","message":"TI is no longer in the running state and task should terminate","current_state":"failed"}},"logger":"task"}
{"timestamp":"2025-07-15T18:21:34.299539","level":"info","event":"Reading all JSON files from HDFS path: hdfs://namenode:8020/event_data/*.json","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:34.323978","level":"info","event":"25/07/15 18:21:34 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:34.331707","level":"info","event":"25/07/15 18:21:34 INFO SharedState: Warehouse path is 'file:/tmp/airflowtmpgxtd90tk/spark-warehouse'.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T18:21:34.922321Z","level":"error","event":"Task killed!","logger":"task"}
