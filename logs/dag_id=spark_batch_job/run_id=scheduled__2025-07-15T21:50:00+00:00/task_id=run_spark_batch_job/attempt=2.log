{"timestamp":"2025-07-15T21:52:22.964563","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-15T21:52:22.965133","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/spark_batch_job_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-15T21:52:22.979981","level":"info","event":"Tmp dir root location: /tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:22.980689","level":"info","event":"Running command: ['/usr/bin/bash', '-c', 'spark-submit --jars /tmp/postgresql-42.7.3.jar /opt/airflow/scripts/spark_jop/batch_jop.py']","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:23.001246","level":"info","event":"Output:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:23.214618","level":"info","event":"WARNING: Using incubator modules: jdk.incubator.vector","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:25.543804","level":"info","event":"25/07/15 21:52:25 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.031806","level":"info","event":"Using Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.040809","level":"info","event":"25/07/15 21:52:28 INFO SparkContext: Running Spark version 4.0.0","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.043222","level":"info","event":"25/07/15 21:52:28 INFO SparkContext: OS info Linux, 6.11.0-29-generic, amd64","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.044314","level":"info","event":"25/07/15 21:52:28 INFO SparkContext: Java version 17.0.15","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.076157","level":"info","event":"25/07/15 21:52:28 INFO ResourceUtils: ==============================================================","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.076568","level":"info","event":"25/07/15 21:52:28 INFO ResourceUtils: No custom resources configured for spark.driver.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.076931","level":"info","event":"25/07/15 21:52:28 INFO ResourceUtils: ==============================================================","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.077815","level":"info","event":"25/07/15 21:52:28 INFO SparkContext: Submitted application: Batch Job","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.113974","level":"info","event":"25/07/15 21:52:28 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.117813","level":"info","event":"25/07/15 21:52:28 INFO ResourceProfile: Limiting resource is cpu","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.119394","level":"info","event":"25/07/15 21:52:28 INFO ResourceProfileManager: Added ResourceProfile id: 0","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.178966","level":"info","event":"25/07/15 21:52:28 INFO SecurityManager: Changing view acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.181397","level":"info","event":"25/07/15 21:52:28 INFO SecurityManager: Changing modify acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.182512","level":"info","event":"25/07/15 21:52:28 INFO SecurityManager: Changing view acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.183544","level":"info","event":"25/07/15 21:52:28 INFO SecurityManager: Changing modify acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.187634","level":"info","event":"25/07/15 21:52:28 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: airflow groups with view permissions: EMPTY; users with modify permissions: airflow; groups with modify permissions: EMPTY; RPC SSL disabled","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.501400","level":"info","event":"25/07/15 21:52:28 INFO Utils: Successfully started service 'sparkDriver' on port 45125.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.542098","level":"info","event":"25/07/15 21:52:28 INFO SparkEnv: Registering MapOutputTracker","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.561152","level":"info","event":"25/07/15 21:52:28 INFO SparkEnv: Registering BlockManagerMaster","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.579368","level":"info","event":"25/07/15 21:52:28 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.580309","level":"info","event":"25/07/15 21:52:28 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.584815","level":"info","event":"25/07/15 21:52:28 INFO SparkEnv: Registering BlockManagerMasterHeartbeat","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.610553","level":"info","event":"25/07/15 21:52:28 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-59ac3e4a-02a0-4fe1-b974-d374793beb56","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.641890","level":"info","event":"25/07/15 21:52:28 INFO SparkEnv: Registering OutputCommitCoordinator","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:28.852107","level":"info","event":"25/07/15 21:52:28 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.040640","level":"info","event":"25/07/15 21:52:29 INFO Utils: Successfully started service 'SparkUI' on port 4040.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.149564","level":"info","event":"25/07/15 21:52:29 INFO SparkContext: Added JAR file:///tmp/postgresql-42.7.3.jar at spark://ee98e9136741:45125/jars/postgresql-42.7.3.jar with timestamp 1752616348019","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.217644","level":"info","event":"25/07/15 21:52:29 INFO SecurityManager: Changing view acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.218081","level":"info","event":"25/07/15 21:52:29 INFO SecurityManager: Changing modify acls to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.218484","level":"info","event":"25/07/15 21:52:29 INFO SecurityManager: Changing view acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.218739","level":"info","event":"25/07/15 21:52:29 INFO SecurityManager: Changing modify acls groups to: airflow","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.221535","level":"info","event":"25/07/15 21:52:29 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: airflow groups with view permissions: EMPTY; users with modify permissions: airflow; groups with modify permissions: EMPTY; RPC SSL disabled","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.675500","level":"info","event":"25/07/15 21:52:29 INFO Executor: Starting executor ID driver on host ee98e9136741","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.677094","level":"info","event":"25/07/15 21:52:29 INFO Executor: OS info Linux, 6.11.0-29-generic, amd64","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.678108","level":"info","event":"25/07/15 21:52:29 INFO Executor: Java version 17.0.15","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.704518","level":"info","event":"25/07/15 21:52:29 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.708350","level":"info","event":"25/07/15 21:52:29 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@2131a33c for default.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.731648","level":"info","event":"25/07/15 21:52:29 INFO Executor: Fetching spark://ee98e9136741:45125/jars/postgresql-42.7.3.jar with timestamp 1752616348019","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.830283","level":"info","event":"25/07/15 21:52:29 INFO TransportClientFactory: Successfully created connection to ee98e9136741/172.19.0.11:45125 after 46 ms (0 ms spent in bootstraps)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.844181","level":"info","event":"25/07/15 21:52:29 INFO Utils: Fetching spark://ee98e9136741:45125/jars/postgresql-42.7.3.jar to /tmp/spark-ddd212ba-75d1-42fd-a3dd-daba9ed3cbbc/userFiles-be09cc0f-2431-4e07-b3a9-56d46bb400eb/fetchFileTemp16817697969678951600.tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.906324","level":"info","event":"25/07/15 21:52:29 INFO Executor: Adding file:/tmp/spark-ddd212ba-75d1-42fd-a3dd-daba9ed3cbbc/userFiles-be09cc0f-2431-4e07-b3a9-56d46bb400eb/postgresql-42.7.3.jar to class loader default","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.925948","level":"info","event":"25/07/15 21:52:29 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 36457.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.926395","level":"info","event":"25/07/15 21:52:29 INFO NettyBlockTransferService: Server created on ee98e9136741:36457","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.930288","level":"info","event":"25/07/15 21:52:29 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.958763","level":"info","event":"25/07/15 21:52:29 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ee98e9136741, 36457, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.971086","level":"info","event":"25/07/15 21:52:29 INFO BlockManagerMasterEndpoint: Registering block manager ee98e9136741:36457 with 434.4 MiB RAM, BlockManagerId(driver, ee98e9136741, 36457, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.977755","level":"info","event":"25/07/15 21:52:29 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ee98e9136741, 36457, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:29.980547","level":"info","event":"25/07/15 21:52:29 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ee98e9136741, 36457, None)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:33.000160","level":"info","event":"Reading all JSON files from HDFS path: hdfs://namenode:8020/event_data/*.json","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:33.011780","level":"info","event":"25/07/15 21:52:33 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-07-15T21:52:33.014749","level":"info","event":"25/07/15 21:52:33 INFO SharedState: Warehouse path is 'file:/tmp/airflowtmpnijakoyg/spark-warehouse'.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
